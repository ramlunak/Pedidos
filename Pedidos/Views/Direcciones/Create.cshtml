@model Pedidos.Models.P_Direcciones

@{
    ViewData["Title"] = "Criar";
}

<h5>Novo Endereço</h5>
<hr />



<div class="row">
    <div class="col-12">

        <form asp-action="Create">

            <div asp-validation-summary="ModelOnly" class="text-danger"></div>
            <input asp-for="idCliente" hidden value="@ViewBag.idCliente" class="form-control" />

            <div class="row col-12">

                @*CEP*@
                <div class="col-md-3">

                    <div class="form-group">
                        <label asp-for="code" class="control-label"></label>

                        <div class="input-group">
                            <input id="code" type="number" class="form-control" asp-for="code">
                            <div class="input-group-append">
                                <span id="cepSearch" class="input-group-text" style="cursor:pointer">
                                    <i style="color:dodgerblue" class="fa fa-search"></i>
                                </span>
                            </div>
                        </div>

                        <span asp-validation-for="code" class="text-danger"></span>
                    </div>

                </div>
                @*RUA*@
                <div class="col-md-5">
                    <div class="form-group">
                        <label asp-for="address" class="control-label"></label>
                        <input id="address" asp-for="address" class="form-control" />
                        <span asp-validation-for="address" class="text-danger"></span>
                    </div>
                </div>
                @*NUMERO*@
                <div class="col-md-2">
                    <div class="form-group">
                        <label asp-for="numero" class="control-label"></label>
                        <input id="numero" type="number" asp-for="numero" class="form-control" />
                        <span asp-validation-for="numero" class="text-danger"></span>
                    </div>
                </div>
                <div class="col-2">
                    <div class="form-group">
                        <label asp-for="complemento" class="control-label"></label>
                        <input id="complemento" asp-for="complemento" class="form-control" />
                        <span asp-validation-for="complemento" class="text-danger"></span>
                    </div>
                </div>
            </div>

            <div class="row col-12">
                @*BARRIO*@
                <div class="col-md-5">
                    <div class="form-group">
                        <label asp-for="district" class="control-label"></label>
                        <input id="district" asp-for="district" class="form-control" />
                        <span asp-validation-for="district" class="text-danger"></span>
                    </div>
                </div>
                @*CIUDAD*@
                <div class="col-md-5">
                    <div class="form-group">
                        <label asp-for="city" class="control-label"></label>
                        <input id="city" asp-for="city" class="form-control" />
                        <span asp-validation-for="city" class="text-danger"></span>
                    </div>
                </div>
                @*ESTADO*@
                <div class="col-md-2">
                    <div class="form-group">
                        <label asp-for="state" class="control-label"></label>
                        <input id="state" asp-for="state" class="form-control" />
                        <span asp-validation-for="state" class="text-danger"></span>
                    </div>
                </div>
            </div>

            <div class="form-group">
                <input type="submit" value="Create" class="btn btn-primary" />
            </div>
        </form>

    </div>
</div>

<div>
    <a asp-route-idCliente="@ViewBag.idCliente" asp-action="Index">Voltar</a>
</div>

@section Scripts {

    <script type="text/javascript">

        function LimpiarNombre() {
            $('#nombre').val('');
            $('#formSearchCategoria').submit();
        }

        $(document).ready(function () {

            $('#cepSearch').on('click', function () {

                $.getJSON('https://ws.apicep.com/cep.json', { code: $('#code').val() }, function (data) {
                    console.log(data);
                    if (JSON.parse(data.ok)) {
                        $('#state').val(data.state);
                        $('#city').val(data.city);
                        $('#district').val(data.district);
                        $('#address').val(data.address);
                    } else {
                        Swal.fire('Oops...', data.message, 'warning');
                        LimpiarCampos();
                    }
                });

            });

            function LimpiarCampos() {
                $('#state').val('');
                $('#city').val('');
                $('#district').val('');
                $('#address').val('');
            }

        });
    </script>

    @{await Html.RenderPartialAsync("_ValidationScriptsPartial");}
}
